I did this on paper and am not convinced I got it right, but using the example from 2.71 I got about O(N logN)